<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Lesson Materials - Teacher Portal</title>
  <link
    rel="stylesheet"
    href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css"
  />
  <style>
    /* Same CSS as your original lesson.html */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
      font-family: "Segoe UI", Tahoma, Geneva, Verdana, sans-serif;
    }
    body {
      background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
      color: #333;
      min-height: 100vh;
      padding: 20px;
    }
    .container { max-width: 1200px; margin: 0 auto; background: white; border-radius: 15px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1); overflow: hidden; }
    header { background: #5c6bc0; color: white; padding: 20px; display: flex; justify-content: space-between; align-items: center; }
    .logo { font-size: 24px; font-weight: bold; display: flex; align-items: center; }
    .logo-icon { margin-right: 10px; font-size: 28px; }
    .teacher-info { display: flex; align-items: center; }
    .teacher-info span.back-link { cursor: pointer; color: white; font-weight: 600; font-size: 18px; user-select: none; }
    .content { padding: 25px; }
    .page-title { color: #5c6bc0; margin-bottom: 20px; padding-bottom: 10px; border-bottom: 2px solid #e8eaf6; }
    .materials-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(300px, 1fr)); gap: 20px; margin: 20px 0; }
    .material-card { background: white; border-radius: 10px; overflow: hidden; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); transition: transform 0.3s ease; position: relative; }
    .material-card:hover { transform: translateY(-5px); box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15); }
    .video-container { position: relative; padding-top: 56.25%; background: #000; cursor: pointer; }
    .video-thumbnail { position: absolute; top: 0; left: 0; width: 100%; height: 100%; object-fit: cover; }
    .play-button { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); font-size: 50px; color: white; opacity: 0.8; transition: opacity 0.3s ease; }
    .video-container:hover .play-button { opacity: 1; }
    .material-details { padding: 15px; }
    .material-details h3 { color: #5c6bc0; margin-bottom: 10px; }
    .material-details p { color: #666; font-size: 14px; margin-bottom: 15px; }
    .material-meta { display: flex; justify-content: space-between; color: #888; font-size: 12px; }
    .material-actions { display: flex; justify-content: space-between; margin-top: 10px; }
    .btn { display: inline-block; padding: 8px 15px; background: #5c6bc0; color: white; text-decoration: none; border-radius: 5px; font-weight: 600; transition: all 0.3s ease; border: none; cursor: pointer; font-size: 14px; }
    .btn:hover { background: #3f51b5; transform: translateY(-2px); }
    .btn:active { transform: translateY(0); }
    .btn-secondary { background: #9fa8da; }
    .btn-secondary:hover { background: #7986cb; }
    .btn-danger { background: #ef5350; }
    .btn-danger:hover { background: #e53935; }
    .upload-section { background: #f9f9f9; padding: 20px; border-radius: 10px; margin: 30px 0; }
    .upload-section h2 { color: #5c6bc0; margin-bottom: 20px; }
    .form-group { margin-bottom: 20px; }
    .form-group label { display: block; margin-bottom: 8px; font-weight: 600; color: #555; }
    .form-group input, .form-group select, .form-group textarea { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 5px; font-size: 16px; }
    .form-group textarea { min-height: 120px; resize: vertical; }
    .file-upload { border: 2px dashed #9fa8da; border-radius: 10px; padding: 25px; text-align: center; margin-bottom: 20px; cursor: pointer; transition: background 0.3s ease; }
    .file-upload:hover { background: #e8eaf6; }
    .file-upload i { font-size: 40px; color: #5c6bc0; margin-bottom: 10px; }
    .file-upload p { color: #666; }
    #video-name, #notes-name { margin-top: 10px; font-weight: 600; color: #5c6bc0; }
    .stats { display: flex; gap: 20px; margin: 20px 0; }
    .stat-item { background: white; padding: 20px; border-radius: 10px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1); flex: 1; text-align: center; }
    .stat-item h3 { color: #5c6bc0; margin-bottom: 10px; }
    .stat-item p { font-size: 24px; font-weight: bold; color: #3f51b5; }
    .notification { position: fixed; top: 20px; right: 20px; padding: 15px 20px; background: #4caf50; color: white; border-radius: 5px; box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2); z-index: 1000; transform: translateX(100%); transition: transform 0.3s ease; }
    .notification.show { transform: translateX(0); }
    .notification.error { background: #f44336; }
    .modal { display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); z-index: 1000; justify-content: center; align-items: center; }
    .modal-content { background: white; padding: 30px; border-radius: 10px; width: 80%; max-width: 500px; }
    .modal-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; padding-bottom: 15px; border-bottom: 1px solid #eee; }
    .modal-header h2 { color: #5c6bc0; margin: 0; }
    .close-modal { background: none; border: none; font-size: 24px; cursor: pointer; color: #888; }
    .modal-actions { display: flex; justify-content: flex-end; gap: 10px; margin-top: 20px; }
    .video-player { width: 100%; max-height: 60vh; }
    .delete-btn { position: absolute; top: 10px; right: 10px; background: rgba(239,83,80,0.9); color: white; border: none; border-radius: 50%; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center; cursor: pointer; opacity: 0; transition: opacity 0.3s ease; z-index: 10; }
    .material-card:hover .delete-btn { opacity: 1; }
    @media (max-width:768px){.materials-grid{grid-template-columns:1fr;}.stats{flex-direction:column;}.delete-btn{opacity:1;}}
  </style>
</head>
<body>
<div class="container">
  <header>
    <div class="logo"><span class="logo-icon">ðŸ§®</span> Abacus Academy Teacher Portal</div>
    <div class="teacher-info"><span class="back-link" onclick="history.back()"> BACK</span></div>
  </header>
  <div class="content">
    <h1 class="page-title">Lesson Materials Management</h1>
    <div class="stats">
      <div class="stat-item"><h3>Total Videos</h3><p id="total-videos">0</p></div>
      <div class="stat-item"><h3>Total Notes</h3><p id="total-notes">0</p></div>
    </div>
    <div class="filter-bar">
      <div class="search-box">
        <input type="text" id="search-input" placeholder="Search materials..." autocomplete="off"/>
        <button class="search-btn" id="search-btn"><i class="fas fa-search"></i></button>
      </div>
      <div class="filter-options">
        <select id="category-filter">
          <option value="all">All Categories</option>
          <option value="introduction">Introduction</option>
          <option value="addition">Addition</option>
          <option value="subtraction">Subtraction</option>
          <option value="multiplication">Multiplication</option>
          <option value="division">Division</option>
          <option value="advanced">Advanced Techniques</option>
        </select>
      </div>
    </div>
    <div class="materials-grid" id="materials-grid"></div>

    <div class="upload-section">
      <h2><i class="fas fa-upload"></i> Upload New Material</h2>
      <form id="upload-form">
        <div class="form-group">
          <label for="title">Title</label>
          <input type="text" id="title" placeholder="Enter lesson title" required/>
        </div>
        <div class="form-group">
          <label for="description">Description</label>
          <textarea id="description" placeholder="Enter lesson description" required></textarea>
        </div>
        <div class="form-group">
          <label>Category</label>
          <select id="category" required>
            <option value="">Select a category</option>
            <option value="introduction">Introduction</option>
            <option value="addition">Addition</option>
            <option value="subtraction">Subtraction</option>
            <option value="multiplication">Multiplication</option>
            <option value="division">Division</option>
            <option value="advanced">Advanced Techniques</option>
          </select>
        </div>
        <div class="form-group">
          <label>Upload Video</label>
          <div class="file-upload" id="video-upload"><i class="fas fa-video"></i><p>Click to upload a video file</p><p id="video-name"></p><input type="file" id="video-file" accept="video/*" style="display:none;" required/></div>
        </div>
        <div class="form-group">
          <label>Upload Notes (PDF)</label>
          <div class="file-upload" id="notes-upload"><i class="fas fa-file-pdf"></i><p>Click to upload notes (PDF)</p><p id="notes-name"></p><input type="file" id="notes-file" accept=".pdf" style="display:none;"/></div>
        </div>
        <button type="submit" class="btn"><i class="fas fa-cloud-upload-alt"></i> Upload Material</button>
      </form>
    </div>
  </div>
</div>

<!-- Video Modal -->
<div class="modal" id="video-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2 id="modal-title">Video Title</h2>
      <button class="close-modal">&times;</button>
    </div>
    <video controls class="video-player" id="modal-video"></video>
  </div>
</div>

<!-- Delete Confirmation Modal -->
<div class="modal" id="delete-modal">
  <div class="modal-content">
    <div class="modal-header">
      <h2>Confirm Delete</h2>
      <button class="close-modal">&times;</button>
    </div>
    <p>Are you sure you want to delete <strong id="delete-material-name"></strong>? This action cannot be undone.</p>
    <div class="modal-actions">
      <button class="btn btn-secondary" id="cancel-delete">Cancel</button>
      <button class="btn btn-danger" id="confirm-delete">Delete</button>
    </div>
  </div>
</div>

<div class="notification" id="notification"></div>

<script>
  const uploadedMaterials = [];

  const materialsGrid = document.getElementById("materials-grid");
  const totalVideosElement = document.getElementById("total-videos");
  const totalNotesElement = document.getElementById("total-notes");
  const notification = document.getElementById("notification");

  const videoUpload = document.getElementById("video-upload");
  const videoFile = document.getElementById("video-file");
  const videoName = document.getElementById("video-name");

  const notesUpload = document.getElementById("notes-upload");
  const notesFile = document.getElementById("notes-file");
  const notesName = document.getElementById("notes-name");

  const form = document.getElementById("upload-form");

  videoUpload.addEventListener("click", () => videoFile.click());
  videoFile.addEventListener("change", () => { if(videoFile.files.length) videoName.textContent = videoFile.files[0].name; });

  notesUpload.addEventListener("click", () => notesFile.click());
  notesFile.addEventListener("change", () => { if(notesFile.files.length) notesName.textContent = notesFile.files[0].name; });

  form.addEventListener("submit", (e) => {
    e.preventDefault();
    if(!videoFile.files.length){ showNotification("Please select a video file","error"); return; }

    const newMaterial = {
      id: uploadedMaterials.length+1,
      title: document.getElementById("title").value,
      description: document.getElementById("description").value,
      category: document.getElementById("category").value,
      videoUrl: URL.createObjectURL(videoFile.files[0]),
      notesFile: notesFile.files.length ? URL.createObjectURL(notesFile.files[0]) : null,
      date: new Date().toLocaleDateString()
    };
    uploadedMaterials.unshift(newMaterial);
    renderMaterials();
    updateStats();
    showNotification("Material uploaded successfully!");
    form.reset();
    videoName.textContent = "";
    notesName.textContent = "";
  });

  function renderMaterials(){
    materialsGrid.innerHTML = "";
    if(!uploadedMaterials.length){ materialsGrid.innerHTML='<div class="empty-state"><i class="fas fa-video-slash"></i><h3>No materials found</h3></div>'; return; }
    uploadedMaterials.forEach(mat=>{
      const card = document.createElement("div");
      card.className="material-card";
      card.innerHTML=`<button class="delete-btn"><i class="fas fa-times"></i></button>
      <div class="video-container"><img class="video-thumbnail" src="https://img.youtube.com/vi/2d2Y79MV8cM/maxresdefault.jpg"/><div class="play-button"><i class="fas fa-play-circle"></i></div></div>
      <div class="material-details">
        <h3>${mat.title}</h3>
        <p>${mat.description}</p>
        <div class="material-meta"><span>${mat.date}</span></div>
        <div class="material-actions">
          <button class="btn download-notes-btn">${mat.notesFile?"Download Notes":"No Notes"}</button>
        </div>
      </div>`;
      const playBtn = card.querySelector(".video-container");
      playBtn.addEventListener("click",()=>{ const modalVideo=document.getElementById("modal-video"); document.getElementById("modal-title").textContent=mat.title; modalVideo.src=mat.videoUrl; document.getElementById("video-modal").style.display="flex"; });
      const downloadBtn = card.querySelector(".download-notes-btn");
      downloadBtn.addEventListener("click",(e)=>{ e.stopPropagation(); if(mat.notesFile){ const a=document.createElement("a"); a.href=mat.notesFile; a.download="notes.pdf"; a.click(); showNotification("Notes downloading..."); } else showNotification("No notes uploaded","error"); });
      materialsGrid.appendChild(card);
    });
  }

  function updateStats(){
    totalVideosElement.textContent = uploadedMaterials.length;
    const notesCount = uploadedMaterials.filter(m=>m.notesFile).length;
    totalNotesElement.textContent = notesCount;
  }

  function showNotification(msg,type="success"){
    notification.textContent = msg;
    notification.className="notification show"+(type==="error"?" error":"");
    setTimeout(()=>{ notification.classList.remove("show"); },3000);
  }

  document.querySelectorAll(".close-modal").forEach(btn=>btn.addEventListener("click",()=>{document.getElementById("video-modal").style.display="none"; document.getElementById("modal-video").pause(); }));
  window.addEventListener("click",(e)=>{ if(e.target.id==="video-modal"){ document.getElementById("video-modal").style.display="none"; document.getElementById("modal-video").pause(); } });
</script>
</body>
</html>
